# Feynman Integral

```@meta
CurrentModule = tropicalfeynman
DocTestSetup = quote
  using tropicalfeynman
end
```

```@setup tropicalfeynman
using tropicalfeynman
```

export graphe,Polynomialring
export polynomialring,constterm, proterm, propagator, coefterm, partition, preimg, sgn,flip,flipV

## Graph

A Feynman graph Î“ of genus g is a trivalent connected graph of genus g.
The graph $G$ is represented as a collection of vertices $V$ and edges $E$. Each edge is a pair $(v,w)$ where both $v$ and $w$ are elements of the set of vertices $V$.

```jldoctest graph
julia> E=[(1, 2), (1,2),(2, 4), (1, 3) ,(3, 4),(3,4)]
6-element Vector{Tuple{Int64, Int64}}:
 (1, 2)
 (1, 2)
 (2, 4)
 (1, 3)
 (3, 4)
 (3, 4)
```

and

```jldoctest graph
julia> G=graphe(E)
graphe([(1, 2), (1, 2), (2, 4), (1, 3), (3, 4), (3, 4)])
```

We then define the $R,x,q=PolynomialRing(G)$ from the graph G.  The polynomial ring has $5g-5$ variables, consisting of two sets of variables: $x_{1},x_{2},...,x_{2g-2}$ and $q_{1},q_{2},...,q_{3g-3}$.

```jldoctest graph
julia>   R,x,q=polynomialring(G)
(Multivariate Polynomial Ring in 10 variables x[1], x[2], x[3], x[4], ..., q[6] over Rational Field, Nemo.fmpq_mpoly[x[1], x[2], x[3], x[4]], Nemo.fmpq_mpoly[q[1], q[2], q[3], q[4], q[5], q[6]])
```

## specific Feynman Integral

For a given branch type *a*, we compute the Feynman Integral of the labeled Graph.
a is the list of degree a the branch type of
the tropical cover at p0

```jldoctest graph
julia> a=[0,2,1,0,0,1]
6-element Vector{Int64}:
 0
 2
 1
 0
 0
 1
```

```jldoctest graph
julia> specificFeynmanIntegral(R,x,q,G,a)
56*q[2]^4*q[3]^2*q[6]^2
```

## Feynman Integral

The Feynman Integral of the graph G, calculated to a specified degree d.

```jldoctest graph
julia> feynmanIntegral(R,x,q,G,4) # here d=4
352*q[1]^8 + 992*q[1]^6*q[2]^2 + 120*q[1]^6*q[5]^2 + 120*q[1]^6*q[6]^2 + 1576*q[1]^4*q[2]^4 + 256*q[1]^4*q[2]^2*q[5]^2 + 256*q[1]^4*q[2]^2*q[6]^2 + 96*q[1]^4*q[3]^4 + 56*q[1]^4*q[3]^2*q[5]^2 + 56*q[1]^4*q[3]^2*q[6]^2 + 96*q[1]^4*q[4]^4 + 56*q[1]^4*q[4]^2*q[5]^2 + 56*q[1]^4*q[4]^2*q[6]^2 + 96*q[1]^4*q[5]^4 + 96*q[1]^4*q[5]^2*q[6]^2 + 96*q[1]^4*q[6]^4 + 992*q[1]^2*q[2]^6 + 256*q[1]^2*q[2]^4*q[5]^2 + 256*q[1]^2*q[2]^4*q[6]^2 + 32*q[1]^2*q[2]^2*q[3]^4 + 32*q[1]^2*q[2]^2*q[4]^4 + 96*q[1]^2*q[2]^2*q[5]^4 + 48*q[1]^2*q[2]^2*q[5]^2*q[6]^2 + 96*q[1]^2*q[2]^2*q[6]^4 + 432*q[1]^2*q[3]^6 + 136*q[1]^2*q[3]^4*q[5]^2 + 136*q[1]^2*q[3]^4*q[6]^2 + 48*q[1]^2*q[3]^2*q[4]^2*q[5]^2 + 48*q[1]^2*q[3]^2*q[4]^2*q[6]^2 + 56*q[1]^2*q[3]^2*q[5]^4 + 56*q[1]^2*q[3]^2*q[6]^4 + 432*q[1]^2*q[4]^6 + 136*q[1]^2*q[4]^4*q[5]^2 + 136*q[1]^2*q[4]^4*q[6]^2 + 56*q[1]^2*q[4]^2*q[5]^4 + 56*q[1]^2*q[4]^2*q[6]^4 + 120*q[1]^2*q[5]^6 + 256*q[1]^2*q[5]^4*q[6]^2 + 256*q[1]^2*q[5]^2*q[6]^4 + 120*q[1]^2*q[6]^6 + 352*q[2]^8 + 120*q[2]^6*q[5]^2 + 120*q[2]^6*q[6]^2 + 96*q[2]^4*q[3]^4 + 56*q[2]^4*q[3]^2*q[5]^2 + 56*q[2]^4*q[3]^2*q[6]^2 + 96*q[2]^4*q[4]^4 + 56*q[2]^4*q[4]^2*q[5]^2 + 56*q[2]^4*q[4]^2*q[6]^2 + 96*q[2]^4*q[5]^4 + 96*q[2]^4*q[5]^2*q[6]^2 + 96*q[2]^4*q[6]^4 + 432*q[2]^2*q[3]^6 + 136*q[2]^2*q[3]^4*q[5]^2 + 136*q[2]^2*q[3]^4*q[6]^2 + 48*q[2]^2*q[3]^2*q[4]^2*q[5]^2 + 48*q[2]^2*q[3]^2*q[4]^2*q[6]^2 + 56*q[2]^2*q[3]^2*q[5]^4 + 56*q[2]^2*q[3]^2*q[6]^4 + 432*q[2]^2*q[4]^6 + 136*q[2]^2*q[4]^4*q[5]^2 + 136*q[2]^2*q[4]^4*q[6]^2 + 56*q[2]^2*q[4]^2*q[5]^4 + 56*q[2]^2*q[4]^2*q[6]^4 + 120*q[2]^2*q[5]^6 + 256*q[2]^2*q[5]^4*q[6]^2 + 256*q[2]^2*q[5]^2*q[6]^4 + 120*q[2]^2*q[6]^6 + 3208*q[3]^8 + 432*q[3]^6*q[5]^2 + 432*q[3]^6*q[6]^2 + 48*q[3]^4*q[4]^4 + 96*q[3]^4*q[5]^4 + 32*q[3]^4*q[5]^2*q[6]^2 + 96*q[3]^4*q[6]^4 + 3208*q[4]^8 + 432*q[4]^6*q[5]^2 + 432*q[4]^6*q[6]^2 + 96*q[4]^4*q[5]^4 + 32*q[4]^4*q[5]^2*q[6]^2 + 96*q[4]^4*q[6]^4 + 352*q[5]^8 + 992*q[5]^6*q[6]^2 + 1576*q[5]^4*q[6]^4 + 992*q[5]^2*q[6]^6 + 352*q[6]^8
```

We then compute the sum of the feynman integral from the degree 1 to d

```jldoctest graph
julia> feynmanIntegralSum(R,x,q,G,4)
352*q[1]^8 + 992*q[1]^6*q[2]^2 + 120*q[1]^6*q[5]^2 + 120*q[1]^6*q[6]^2 + 24*q[1]^6 + 1576*q[1]^4*q[2]^4 + 256*q[1]^4*q[2]^2*q[5]^2 + 256*q[1]^4*q[2]^2*q[6]^2 + 152*q[1]^4*q[2]^2 + 96*q[1]^4*q[3]^4 + 56*q[1]^4*q[3]^2*q[5]^2 + 56*q[1]^4*q[3]^2*q[6]^2 + 96*q[1]^4*q[4]^4 + 56*q[1]^4*q[4]^2*q[5]^2 + 56*q[1]^4*q[4]^2*q[6]^2 + 96*q[1]^4*q[5]^4 + 96*q[1]^4*q[5]^2*q[6]^2 + 8*q[1]^4*q[5]^2 + 96*q[1]^4*q[6]^4 + 8*q[1]^4*q[6]^2 + 992*q[1]^2*q[2]^6 + 256*q[1]^2*q[2]^4*q[5]^2 + 256*q[1]^2*q[2]^4*q[6]^2 + 152*q[1]^2*q[2]^4 + 32*q[1]^2*q[2]^2*q[3]^4 + 32*q[1]^2*q[2]^2*q[4]^4 + 96*q[1]^2*q[2]^2*q[5]^4 + 48*q[1]^2*q[2]^2*q[5]^2*q[6]^2 + 32*q[1]^2*q[2]^2*q[5]^2 + 96*q[1]^2*q[2]^2*q[6]^4 + 32*q[1]^2*q[2]^2*q[6]^2 + 8*q[1]^2*q[2]^2 + 432*q[1]^2*q[3]^6 + 136*q[1]^2*q[3]^4*q[5]^2 + 136*q[1]^2*q[3]^4*q[6]^2 + 32*q[1]^2*q[3]^4 + 48*q[1]^2*q[3]^2*q[4]^2*q[5]^2 + 48*q[1]^2*q[3]^2*q[4]^2*q[6]^2 + 56*q[1]^2*q[3]^2*q[5]^4 + 8*q[1]^2*q[3]^2*q[5]^2 + 56*q[1]^2*q[3]^2*q[6]^4 + 8*q[1]^2*q[3]^2*q[6]^2 + 432*q[1]^2*q[4]^6 + 136*q[1]^2*q[4]^4*q[5]^2 + 136*q[1]^2*q[4]^4*q[6]^2 + 32*q[1]^2*q[4]^4 + 56*q[1]^2*q[4]^2*q[5]^4 + 8*q[1]^2*q[4]^2*q[5]^2 + 56*q[1]^2*q[4]^2*q[6]^4 + 8*q[1]^2*q[4]^2*q[6]^2 + 120*q[1]^2*q[5]^6 + 256*q[1]^2*q[5]^4*q[6]^2 + 8*q[1]^2*q[5]^4 + 256*q[1]^2*q[5]^2*q[6]^4 + 32*q[1]^2*q[5]^2*q[6]^2 + 120*q[1]^2*q[6]^6 + 8*q[1]^2*q[6]^4 + 352*q[2]^8 + 120*q[2]^6*q[5]^2 + 120*q[2]^6*q[6]^2 + 24*q[2]^6 + 96*q[2]^4*q[3]^4 + 56*q[2]^4*q[3]^2*q[5]^2 + 56*q[2]^4*q[3]^2*q[6]^2 + 96*q[2]^4*q[4]^4 + 56*q[2]^4*q[4]^2*q[5]^2 + 56*q[2]^4*q[4]^2*q[6]^2 + 96*q[2]^4*q[5]^4 + 96*q[2]^4*q[5]^2*q[6]^2 + 8*q[2]^4*q[5]^2 + 96*q[2]^4*q[6]^4 + 8*q[2]^4*q[6]^2 + 432*q[2]^2*q[3]^6 + 136*q[2]^2*q[3]^4*q[5]^2 + 136*q[2]^2*q[3]^4*q[6]^2 + 32*q[2]^2*q[3]^4 + 48*q[2]^2*q[3]^2*q[4]^2*q[5]^2 + 48*q[2]^2*q[3]^2*q[4]^2*q[6]^2 + 56*q[2]^2*q[3]^2*q[5]^4 + 8*q[2]^2*q[3]^2*q[5]^2 + 56*q[2]^2*q[3]^2*q[6]^4 + 8*q[2]^2*q[3]^2*q[6]^2 + 432*q[2]^2*q[4]^6 + 136*q[2]^2*q[4]^4*q[5]^2 + 136*q[2]^2*q[4]^4*q[6]^2 + 32*q[2]^2*q[4]^4 + 56*q[2]^2*q[4]^2*q[5]^4 + 8*q[2]^2*q[4]^2*q[5]^2 + 56*q[2]^2*q[4]^2*q[6]^4 + 8*q[2]^2*q[4]^2*q[6]^2 + 120*q[2]^2*q[5]^6 + 256*q[2]^2*q[5]^4*q[6]^2 + 8*q[2]^2*q[5]^4 + 256*q[2]^2*q[5]^2*q[6]^4 + 32*q[2]^2*q[5]^2*q[6]^2 + 120*q[2]^2*q[6]^6 + 8*q[2]^2*q[6]^4 + 3208*q[3]^8 + 432*q[3]^6*q[5]^2 + 432*q[3]^6*q[6]^2 + 288*q[3]^6 + 48*q[3]^4*q[4]^4 + 96*q[3]^4*q[5]^4 + 32*q[3]^4*q[5]^2*q[6]^2 + 32*q[3]^4*q[5]^2 + 96*q[3]^4*q[6]^4 + 32*q[3]^4*q[6]^2 + 8*q[3]^4 + 3208*q[4]^8 + 432*q[4]^6*q[5]^2 + 432*q[4]^6*q[6]^2 + 288*q[4]^6 + 96*q[4]^4*q[5]^4 + 32*q[4]^4*q[5]^2*q[6]^2 + 32*q[4]^4*q[5]^2 + 96*q[4]^4*q[6]^4 + 32*q[4]^4*q[6]^2 + 8*q[4]^4 + 352*q[5]^8 + 992*q[5]^6*q[6]^2 + 24*q[5]^6 + 1576*q[5]^4*q[6]^4 + 152*q[5]^4*q[6]^2 + 992*q[5]^2*q[6]^6 + 152*q[5]^2*q[6]^4 + 8*q[5]^2*q[6]^2 + 352*q[6]^8 + 24*q[6]^6

```jldoctest graph
julia> subt(R,x,q,feynmanIntegralSum(R,x,q,G,4))

25344*q[1]^8 + 1792*q[1]^6 + 32*q[1]^4

```
